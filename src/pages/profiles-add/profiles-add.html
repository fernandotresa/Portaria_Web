
<ion-header>

  <ion-navbar text-center no-border-bottom color="primary">  
  
  <ion-title> {{dataInfo.titlePermissionsAccess}} </ion-title>   
   
   <ion-buttons end *ngIf="false">
    <button ion-button [disabled]="isToday" (click)="today()">Hoje</button>
    <button ion-button (click)="changeMode('month')">M</button>
    <button ion-button (click)="changeMode('week')">S</button>
    <button ion-button (click)="changeMode('day')">D</button>
  </ion-buttons>

    <ion-buttons end>
            <button ion-button color="white_" (click)="goHome()">
            <ion-icon name="home"></ion-icon></button>
        </ion-buttons>

    <ion-buttons end>
        <button ion-button menuToggle color="white_">
            <ion-icon name="menu"></ion-icon></button>
    </ion-buttons>  
   
 </ion-navbar>  

</ion-header>


<ion-content padding>

<ion-list no-lines>

  <ion-list-header color="primary" *ngIf="! selectedAccessType">{{dataInfo.titleProfile}}</ion-list-header>  
  <ion-list-header color="primary" *ngIf="selectedAccessType">{{selectedAccessType}}</ion-list-header>  

  <ion-item no-lines>
    <ion-label>{{dataInfo.titleName}}</ion-label>
    <ion-input type="text" [(ngModel)]="name" text-right></ion-input>
  </ion-item>

  <ion-item no-lines>
      <ion-label>{{dataInfo.titleDescription}}</ion-label>
      <ion-input type="text" [(ngModel)]="desc" text-right></ion-input>
    </ion-item>

    <ion-item no-lines *ngIf="false">
      <ion-label>{{dataInfo.titleAccessType}}</ion-label>   
       
      <ion-select [(ngModel)]="selectedAccessType">
        <ion-option  *ngFor="let type of (accessTypes | async)?.success" no-lines>{{type.name}}</ion-option>        
      </ion-select>
    </ion-item>

    <ion-item>

        <ion-row>
            <ion-col *ngIf="selectedAccessType && selectedAccessType !== 'Dias da Semana + horários'">
                <ion-label>{{dataInfo.titleDayStart}}</ion-label>
            </ion-col>

            <ion-col *ngIf="selectedAccessType && selectedAccessType !== 'Dias da Semana + horários'">

                <ion-datetime  *ngIf="selectedAccessType === 'Período'" class="stroke-bottom" displayFormat="DD/MM/YYYY" pickerFormat="DD/MM/YYYY" [(ngModel)]="dateStart" (ionChange)="dataStartChanged()"></ion-datetime>
                <ion-datetime  *ngIf="selectedAccessType !== 'Período'" class="stroke-bottom" displayFormat="DD/MM/YYYY HH:mm" pickerFormat="DD/MM/YYYY HH:mm" [(ngModel)]="dateStart" (ionChange)="dataStartChanged()"></ion-datetime>
            </ion-col>                        

            <ion-col *ngIf="selectedAccessType && selectedAccessType !== 'Dias da Semana + horários'">
                <ion-label>{{dataInfo.titleEndStart}}</ion-label>
            </ion-col>

            <ion-col *ngIf="selectedAccessType && selectedAccessType !== 'Dias da Semana + horários'">
                <ion-datetime *ngIf="selectedAccessType === 'Período'" class="stroke-bottom"  displayFormat="DD/MM/YYYY" pickerFormat="DD/MM/YYYY" [(ngModel)]="dateEnd" (ionChange)="dataEndChanged()"></ion-datetime>
                <ion-datetime *ngIf="selectedAccessType !== 'Período'" class="stroke-bottom"  displayFormat="DD/MM/YYYY HH:mm" pickerFormat="DD/MM/YYYY HH:mm" [(ngModel)]="dateEnd" (ionChange)="dataEndChanged()"></ion-datetime>
            </ion-col>

        </ion-row>        
    </ion-item>    
  
    <ion-list-header color="primary" *ngIf="false"> 

    <ion-item no-lines item-end text-center class="list-header-cal" *ngIf="false">        
        <ion-checkbox (click)="calendarDateClicked()" [(ngModel)]="hasDate"></ion-checkbox>
        <ion-label>{{dataInfo.titleCalendar}}</ion-label>      
    </ion-item>

    <ion-item no-lines item-end text-center class="list-header-cal" *ngIf="false">                    
        <ion-checkbox (click)="calendarDatetimeClicked()" [(ngModel)]="hasDatetime"></ion-checkbox>        
        <ion-label>{{dataInfo.titleCalendarDatetime}}</ion-label>  
    </ion-item>

    </ion-list-header>  

    <ion-list-header color="primary" 
        *ngIf="selectedAccessType && selectedAccessType !== 'Dias da Semana + horários'"> 
        <ion-label text-center>{{selectedMonth}}</ion-label>  
    </ion-list-header>  

    <ng-template #template let-view="view" let-row="row" let-col="col" let-showEventDetail="showEventDetail">        

        <div *ngIf="view.dates[row*7+col].events.length > 0">         
          <div class="calendar-day {{ view.dates[row*7+col].events[0]?.color }}"> {{view.dates[row*7+col].label}}</div>
      </div> 
  
      <div *ngIf="view.dates[row*7+col].events.length === 0">         
          <div class="calendar-day warning"> {{view.dates[row*7+col].label}}</div>
      </div>
  
    </ng-template>

    <calendar 
        [monthviewDisplayEventTemplate]="template"
        [eventSource]="eventSource"
        [calendarMode]="calendar.mode"
        [currentDate]="calendar.currentDate"
        [showEventDetail]="false"
        [locale]="calendar.locale"
        (onCurrentDateChanged)="onCurrentDateChanged($event)"
        (onTimeSelected)="onTimeSelected($event)"        
        (onTitleChanged)="onViewTitleChanged($event)"
        [step]="30"
        class="has-header"
        *ngIf="selectedAccessType && selectedAccessType !== 'Dias da Semana + horários'">
      </calendar>           

  <ion-list-header color="primary" *ngIf="selectedAccessType == 'Dias da Semana + horários'">{{dataInfo.titleDaysWeek}}</ion-list-header>  

    <ion-item no-lines *ngIf="selectedAccessType == 'Dias da Semana + horários'">              
      <ion-item no-lines item-end>
          <ion-checkbox [(ngModel)]="monday"></ion-checkbox>
          <ion-label>{{dataInfo.titleMonday}}</ion-label>  
      </ion-item>
      <ion-item no-lines item-end *ngIf="monday">            
          <ion-datetime displayFormat="HH:mm" pickerFormat="HH:mm" [(ngModel)]="mondayStart"></ion-datetime>
      </ion-item>
      <ion-item no-lines item-end *ngIf="monday">
          <ion-datetime displayFormat="HH:mm" pickerFormat="HH:mm" [(ngModel)]="mondayEnd"></ion-datetime>                    
      </ion-item>     
    </ion-item>

    <ion-item no-lines *ngIf="selectedAccessType == 'Dias da Semana + horários'">              
      <ion-item no-lines item-end>
        
          <ion-checkbox [(ngModel)]="tuesday"></ion-checkbox>
          <ion-label>{{dataInfo.titleTuesday}}</ion-label>  
      </ion-item>
      <ion-item no-lines item-end *ngIf="tuesday">            
          <ion-datetime displayFormat="HH:mm" pickerFormat="HH:mm" [(ngModel)]="tuesdayStart"></ion-datetime>
      </ion-item>
      <ion-item no-lines item-end *ngIf="tuesday">
          <ion-datetime displayFormat="HH:mm" pickerFormat="HH:mm" [(ngModel)]="tuesdayEnd"></ion-datetime>                    
      </ion-item>     
    </ion-item>

  <ion-item no-lines *ngIf="selectedAccessType == 'Dias da Semana + horários'">              
    <ion-item no-lines item-end>
        <ion-checkbox [(ngModel)]="wednesday"></ion-checkbox>
        <ion-label>{{dataInfo.titleWednesday}}</ion-label>  
    </ion-item>
    <ion-item no-lines item-end *ngIf="wednesday">            
        <ion-datetime displayFormat="HH:mm" pickerFormat="HH:mm" [(ngModel)]="wednesdayStart"></ion-datetime>
    </ion-item>
    <ion-item no-lines item-end *ngIf="wednesday">
        <ion-datetime displayFormat="HH:mm" pickerFormat="HH:mm" [(ngModel)]="wednesdayEnd"></ion-datetime>                    
    </ion-item>     
  </ion-item>

  <ion-item no-lines *ngIf="selectedAccessType == 'Dias da Semana + horários'">              
      <ion-item no-lines item-end>
          <ion-checkbox [(ngModel)]="thursday"></ion-checkbox>
          <ion-label>{{dataInfo.titleThursday}}</ion-label>  
      </ion-item>
      <ion-item no-lines item-end *ngIf="thursday">            
          <ion-datetime displayFormat="HH:mm" pickerFormat="HH:mm" [(ngModel)]="thursdayStart"></ion-datetime>
      </ion-item>
      <ion-item no-lines item-end *ngIf="thursday">
          <ion-datetime displayFormat="HH:mm" pickerFormat="HH:mm" [(ngModel)]="thursdayEnd"></ion-datetime>                    
      </ion-item>     
    </ion-item>

    <ion-item no-lines *ngIf="selectedAccessType == 'Dias da Semana + horários'">              
        <ion-item no-lines item-end>
            <ion-checkbox [(ngModel)]="friday"></ion-checkbox>
            <ion-label>{{dataInfo.titleFriday}}</ion-label>  
        </ion-item>
        <ion-item no-lines item-end *ngIf="friday">            
            <ion-datetime displayFormat="HH:mm" pickerFormat="HH:mm" [(ngModel)]="fridayStart"></ion-datetime>
        </ion-item>
        <ion-item no-lines item-end *ngIf="friday">
            <ion-datetime displayFormat="HH:mm" pickerFormat="HH:mm" [(ngModel)]="fridayEnd"></ion-datetime>                    
        </ion-item>     
      </ion-item>

      <ion-item no-lines *ngIf="selectedAccessType == 'Dias da Semana + horários'">              
          <ion-item no-lines item-end>
              <ion-checkbox [(ngModel)]="saturday"></ion-checkbox>
              <ion-label>{{dataInfo.titleSaturday}}</ion-label>  
          </ion-item>

          <ion-item no-lines item-end *ngIf="saturday">            
              <ion-datetime displayFormat="HH:mm" pickerFormat="HH:mm" [(ngModel)]="saturdayStart"></ion-datetime>
          </ion-item>
          <ion-item no-lines item-end *ngIf="saturday">
              <ion-datetime displayFormat="HH:mm" pickerFormat="HH:mm" [(ngModel)]="saturdayEnd"></ion-datetime>                    
          </ion-item>     
        </ion-item>

      <ion-item no-lines *ngIf="selectedAccessType == 'Dias da Semana + horários'">              
          <ion-item no-lines item-end>
              <ion-checkbox  checked="false"  [(ngModel)]="sunday"></ion-checkbox>
              <ion-label>{{dataInfo.titleSunday}}</ion-label>  
          </ion-item>
          
          <ion-item no-lines item-end *ngIf="sunday">            
              <ion-datetime displayFormat="HH:mm" pickerFormat="HH:mm" [(ngModel)]="sundayStart"></ion-datetime>
          </ion-item>
          <ion-item no-lines item-end *ngIf="sunday">
              <ion-datetime displayFormat="HH:mm" pickerFormat="HH:mm" [(ngModel)]="sundayEnd"></ion-datetime>                    
          </ion-item>     
        </ion-item>                
    
</ion-list>
  
</ion-content>

<ion-footer>
  <button ion-button full (click)="clearCal()" *ngIf="eventSource.length > 0">{{dataInfo.titleCleanCal}}</button>
  <button ion-button full (click)="addProfile()" *ngIf="! loadProfile">{{dataInfo.titleRegister}}</button>
  <button ion-button full (click)="updateProfile()" *ngIf="loadProfile">{{dataInfo.titleSave}}</button>
</ion-footer>
